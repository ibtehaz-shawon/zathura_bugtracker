{% extends "base_with_nav.html" %}
{% block title %} {{ page_title }} {% endblock %}

{%block teams %}
{% if teams %}
<script type="text/javascript">
    set_local_storage_data("teams", {{ teams| safe }});
</script>
{% for team in teams %}
<a class="dropdown-item" id="nav_team" onclick="org_selected('{{ team.team_name }}')">{{ team.team_name }}</a>
{% endfor %}
<div class="dropdown-divider"></div>
{% endif %}

{% endblock %}

{%block project_teams %}
{% if teams %}
<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    {% for team in teams %}
    <option value="{{ team.team_id }}">{{ team.team_name }}</option>
    {% endfor %}
</div>
{% else %}
<p class="h4"> You need an organization to create a project. </p>
{% endif %}
{% endblock %}


{%block projects %}
{% if projects %}
<script type="text/javascript">
    set_local_storage_data("projects", {{ projects | safe }});
</script>
{% for project in projects %}
<!-- project.project_id -->
<a class="dropdown-item" href="{% url "project" project.project_id %}"> {{ project.project_name }}</a>
{% endfor %}
<div class="dropdown-divider"></div>
{% endif %}
{% endblock %}




{% block content %}
<!-- # create an organization modal
<!-- Modal -->

<div class="container">

    <br>
    <div class="row">
        <div class="col-6">
            <!-- Project details -->
            {% if project_object %}
            <p class="h4"> Project - {{project_object.project_name}}</p>
            <p class="h6"> Team - {{project_object.team.team_name}}</p>
            <!-- Apply local timezone here -->
            <p class="h6"> Created on - {{project_object.created_on}}</p>
            <hr>

            {% if project_token %}
            <p class="h6"> Project Token: <strong>{{ project_token.token }}</strong> </p>
            <p class="h6"> Generated On: {{ project_token.generated_on }} </p>
            <p class="h6"> Updated On: {{  project_token.updated_on }} </p>
            <p class="h6"> Last Access: {{project_token.last_access }} </p>
            <p class="h6"> Active: {{ project_token.is_active }}</p>
            <button type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#create_project_token">
                Generate A New Token
            </button>
            {% else %}
            <div class="row">
                <div class="col-8">
                    <p class="h6">
                        Project Token - <strong> not generated yet </strong>
                    </p>
                </div>

                <div class="col-4">
                    <button type="button" class="btn btn-primary btn-sm" data-toggle="modal"
                        data-target="#create_project_token">
                        Generate
                    </button>
                </div>
            </div>
            {% endif %}


            <hr>

            <div class="row">
                <div class="col-8">
                    <small class="text-muted"> Last updated on: {{ project_object.modified_on}}</small>
                </div>

                <div class="col-4">
                    <button type="button" class="btn btn-outline-info btn-sm">Update</button>
                </div>
            </div>

            {% else %}
            <p class="h1"> Project does not existo </p>
            <!-- TODO: Load HTTP 404 not found page here -->
            {% endif %}
        </div>

        <div class="col-6">
            <!-- TODO: Other project details if needed -->
            <p class="h5">Total Error Count : {{error_count}}</p>
            <p class="h5">Total Verbose Log Count : {{verbose_count}}</p>

        </div>


    </div>
</div>

<!-- |||||||||||||||||||||||||||||||||| -->
<!-- |||||||||||||||||||||||||||||||||| -->
<!-- Generate Project Token -->
<!-- |||||||||||||||||||||||||||||||||| -->
<!-- |||||||||||||||||||||||||||||||||| -->

<div class="modal fade" id="create_project_token" tabindex="-1" role="dialog" aria-labelledby="createProjectCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="createOrgLongTitle">Generate Project Token</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="card-text">Lorem ipsum dolor sit amet consectetur adipisicing elit. Aliquid, at, in quos
                    cupiditate vero aut
                    consequuntur, natus qui delectus nesciunt harum eveniet. Repudiandae velit consequuntur,
                    officiis
                    eligendi
                    ullam beatae laudantium?
                </p>
                <form method="POST" action="{% url 'project_token' %}">
                    {% csrf_token %}
                    <div class="form-group">
                        <input type="hidden" name="project_id" class="form-control" id="input_project_id"
                            value="{{ project_object.project_id }}">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Generate</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}